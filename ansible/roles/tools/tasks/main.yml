- name: "Installing Good Packages"
  apt: pkg={{ item }} state=latest
  with_items:
  - git
  - vim
  - nano
  - ansible
  - w3m

- name: "Enable git credential store"
  shell: git config --global credential.helper store

- name: set vim as default editor
  command: update-alternatives --set editor /usr/bin/vim.basic

- name: Ensure /srv/updater/bin exists
  shell: creates=/srv/updater/bin warn=no mkdir -p /srv/updater/bin

- name: create update script
  copy:
    src: update.sh
    dest: /srv/updater/bin/update.sh
    owner: root
    group: root
    mode: '0755'

- name: create update cron
  cron:
    name: "updater"
    job: '/srv/updater/bin/update.sh'
    hour: '1,13'
    minute: 0

- name: create reboot cron
  cron:
    name: "rebooter"
    job: 'reboot'
    day: '1'
    hour: '2'
    minute: '0'
